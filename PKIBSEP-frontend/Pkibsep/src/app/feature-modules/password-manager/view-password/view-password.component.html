<h2 mat-dialog-title>Pregled Lozinke</h2>

<mat-dialog-content>
  <div class="info-section">
    <div class="info-row">
      <strong>Sajt:</strong>
      <span>{{ passwordEntry.siteName }}</span>
    </div>
    <div class="info-row">
      <strong>Korisničko ime:</strong>
      <span>{{ passwordEntry.username }}</span>
    </div>
    <div class="info-row">
      <strong>Vlasnik:</strong>
      <span *ngIf="passwordEntry.isOwner" class="owner-badge">Vi</span>
      <span *ngIf="!passwordEntry.isOwner">{{ passwordEntry.ownerEmail }}</span>
    </div>
  </div>

  <mat-divider></mat-divider>

  <div class="decrypt-section">
    <div *ngIf="!decryptedPassword" class="upload-section">
      <p class="instruction">
        <mat-icon>lock</mat-icon>
        Za prikaz lozinke, upload-ujte vaš privatni ključ:
      </p>

      <input type="file" #fileInput (change)="onFileSelected($event)"
             accept=".pem,.key" style="display: none;">

      <button mat-raised-button color="primary" (click)="fileInput.click()"
              [disabled]="isDecrypting">
        <mat-icon>upload_file</mat-icon>
        {{ isDecrypting ? 'Dekriptovanje...' : 'Izaberi Privatni Ključ' }}
      </button>
    </div>

    <div *ngIf="decryptedPassword" class="password-display">
      <mat-form-field class="full-width">
        <mat-label>Dekriptovana Lozinka</mat-label>
        <input matInput [type]="hidePassword ? 'password' : 'text'"
               [value]="decryptedPassword" readonly>
        <button mat-icon-button matSuffix (click)="hidePassword = !hidePassword" type="button">
          <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
        </button>
      </mat-form-field>

      <button mat-raised-button color="accent" (click)="copyToClipboard()" class="copy-btn">
        <mat-icon>content_copy</mat-icon>
        Kopiraj u Clipboard
      </button>

      <div class="success-box">
        <mat-icon>check_circle</mat-icon>
        <p>Lozinka je uspešno dekriptovana!</p>
      </div>
    </div>
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="onClose()">Zatvori</button>
</mat-dialog-actions>
